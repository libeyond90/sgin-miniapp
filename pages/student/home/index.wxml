<!--pages/teacher/home/index.wxml-->
<navbar  title="å­¦ç”Ÿç³»ç»Ÿ" />


<view class="page">
  <wxs src="../../../utils/util.wxs" module="dateFormatter"></wxs>
  <image class="bg-image" src="../../../image/bg.jpg" mode="aspectFill"></image>
  <!-- é¡¶éƒ¨ä¸ªäººä¿¡æ¯åŒºåŸŸ -->
  <view class="top-section">
    <!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
    <view class="info-card">
      <view class="card-header">
        <view class="user-info">
          <view class="user-detail">
            <text class="name">{{userInfo.name}}</text>
            <text class="qd-class-id info-value">ç­çº§id:{{currentClass.id}}</text>
          </view>
        </view>
      </view>
      <view class="card-body">
        <view class="info-item">
          <view class="info-icon">ğŸ“š</view>
          <view class="info-content">
            <text class="info-value">{{currentClass.subject}}</text>
          </view>
        </view>
        <view class="info-item">
          <view class="info-icon">ğŸ‘¥</view>
          <view class="info-content">
            <text class="info-value">{{currentClass.name}}</text>
          </view>
        </view>
        <!-- æ·»åŠ ç­çº§äººæ•°ç»Ÿè®¡ -->
        <view class="info-item">
          <view class="info-icon">ğŸ‘¨â€ğŸ«</view>
          <view class="info-content">
            <text class="info-label">ç­çº§äººæ•°</text>
            <view class="count-box">
              <text class="count-item">è€å¸ˆ {{classCounts.tcount || 0}}</text>
              <text class="count-item">å­¦ç”Ÿ {{classCounts.scount || 0}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
    <!-- <button class="publish-btn" bindtap="onCreateSignTask">
      <text class="btn-icon">âœï¸</text>
      <text>å‘å¸ƒæ‰“å¡ä»»åŠ¡</text>
    </button> -->
  </view>

  <!-- çŠ¶æ€ç­›é€‰åŒºåŸŸ -->
  <view class="filter-section">
    <view class="filter-tabs">
      <view class="filter-tab {{signIn === 2 ? 'active' : ''}}" 
            bindtap="onStatusChange" 
            data-type="2">
        æœªæ‰“å¡
      </view>
      <view class="filter-tab {{signIn === 0 ? 'active' : ''}}" 
            bindtap="onStatusChange" 
            data-type="">
        å…¨éƒ¨
      </view>
      <view class="filter-tab {{signIn === 1 ? 'active' : ''}}" 
            bindtap="onStatusChange" 
            data-type="1">
        å·²æ‰“å¡
      </view>
    </view>
  </view>

  <!-- ä»»åŠ¡åˆ—è¡¨åŒºåŸŸ -->
  <view class="task-list">
    <block wx:if="{{taskList.length > 0}}">
      <view class="task-item" wx:for="{{taskList}}" wx:key="id" bindtap="onTaskTap" data-task="{{item}}">
        <view class="task-header">
          <text class="task-name">{{item.title}}</text>
          <text class="distance-tag">{{item.distance}}m</text>
        </view>
        
        <view class="location-row">
          <text class="location-icon">ğŸ“</text>
          <text class="location-text">{{item.address}}</text>
        </view>

        <view class="task-footer">
          <text class="creator-name">{{item.createName}} {{item.createPosition}}</text>
          <text class="deadline-time">{{dateFormatter.formatDate(item.deadline,'yyyy-MM-dd HH:mm')}}</text>
        </view>
      </view>
      <view class="list-bottom-text">æ²¡æœ‰æ›´å¤šå•¦~</view>
    </block>
    <view class="empty-tip" wx:else>
      <text class="empty-icon">ğŸ“</text>
      <text>æš‚æ— {{currentStatus === 'ongoing' ? 'è¿›è¡Œä¸­çš„' : currentStatus === 'ended' ? 'å·²ç»“æŸçš„' : ''}}ä»»åŠ¡~</text>
    </view>
  </view>
</view>